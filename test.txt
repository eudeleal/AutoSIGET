Linha    Oso      Tipo  NomePdf
####-00  ####-00  B     FH ####-## ####-##
####-0#  ####-0#  D     QH ####-## ####-##

VARIÁVEIS:
    linha = row.get("linha", row.get("linha ", "")).strip()
    oso = row.get("oso", row.get("oso ", "")).strip()
    oso_dig = row.get("oso_dig", row.get("oso_dig ", "")).strip()
    tipo = row.get("tipo", row.get("tipo ", "")).strip()
    OsoAtiva = row.get("OsoAtiva", row.get("OsoAtiva ", "")).strip()
    fQH = row.get("fQH", row.get("fQH ", "")).strip()
    OsoDerivada = row.get("OsoDerivada", row.get("OsoDerivada ", "")).strip()
    NomePDF = f"{fQH} {linha} {oso_dig}"

DIRETÓRIO:
    ../AutoSiget300/FQHs
    
EXEMPLO NO CÓDIGO:
    pyautogui.press("tab")
    registrar_log(f"[{oso_label}] tab → campo OSO")
    print_user(f"Preenchendo OSO:     {oso}")
    sleep.time(0.3)

    pyautogui.write()
    registrar_log(f"[{oso_label}] escreveu OSO '{oso}'")
    print_user(f"Preenchendo NomePDF: {NomePDF}")
    time.sleep(0.3)

LÓGICA:
    DIGITA oso

# Tab                                            | Informe o N° da OSO - Imprimir em

    if OsoAtiva and OsoDerivada:
        print_user(Aviso de OSO filha detectada)
    # Tab                                            | SIM - NÃO
    # Enter                                          | Confirma NÃO

# Tab x 2                                        | Imprimir em - Configurar - Imprimir
# Enter                                          | Confirma Imprimir

    DIGITA NomePDF

# Enter                                          | Confirma SALVAR

    if ArquivoExiste(NomePDF):
        # PDF salvo com sucesso
    else:
        # PDF não encontrado, verifique a pasta SALVAR

        # Escolha repetir ou continuar
    
    # Escolha repetir ou continuar


INCIO {
Intro()                                                                                                          | Exibe introdução
    registrar_log(mensagem: str)                                                                                 | Cria e Salva o log
    < return none
    print_user(msg: str)
        < return msg [string]                                                                                         | Exibe mensagem ao Usuário
        registrar_log(mensagem: str)            
    main()                                                                                                       | Inicia o menu principal, exibe o cabeçalho e seleciona os módulos
        pedirCSV                                                                                                 | Solicita o nome do CSV [string]
            carregar_csv(Nomecsv)                                                                                | Recebe o arquivo e retorna uma lista do CSV e uma lista com o cabeçalho
                < return csv [list[dict]], cabecalho [list]
        IniciarModulo_ProgramacaoLinha(csv)                                                                      | Exibe instruções
            gerar_blocos(csv)                                                                                    | Cria uma lista de dicios com chaves, linha inicial e final e qtd de linhas
                < return blocos [list[dict]]
            seletorBlocos(csv, blocos)                                                                           | Solicita o nº inicial do bloco [int]
                < return csv [list[dict]], blocos [list[dict]], bloco_inicio_index [int]
                preencher_blocos(csv, blocos, bloco_inicio_index)                                                | Controla o preenchimento dos blocos
                    < return trecho [list], faixaFimAnterior [string], prox_idx [string], prox_id_bloco [string]
                    preencher_faixa(row, linha_label, faixaFimAnterior)                                          | Executa a digitação das linhas do bloco
                    < return none
                        formatar_hora_log(faixaIni_raw)
                        < return h [string]
                        formatar_hora_log(faixaFim_raw)
                        < return h [string]
                        formatar_hora_dig(faixaIni_raw)
                        < return h [string]
                        formatar_hora_dig(faixaFim_raw)
                        < return h [string]
                            main()
            IniciarModulo_ImprimirPDFs(csv)
            tratarOso(csv)                                                                                       | Limpa os outroas linha a partir do tamanho da coluna "OSOs" do CSV
                < return osos [list[dict]]
            seletorOsos(osos)                                                                                    | Solicita o nº inicial da lista de OSOs [int]
                < return osos [list[dict]], osos_inicial_index [int]
                preencher_PDFs(osos, osos_inicial_index)                                                         | Controla a impressão das OSOs, Solicita o "FH" ou "QH", Solicita Ativa ou Desativada, Verifica se tem OsoDerivada
                < return fQH [string], OsoAtiva [bool], OsoDerivada [bool],  row [int], osos [list[dict]]
                    imprimirPDF(row, osos, OsoAtiva, OsoDerivada, fQH)                                           | Executa a digitação das linhas da OSO
                    < return none
                        main()
} FIM

INCIO {
    def global escutador_tecla()
    < return none

    class loggs(msg)
        print_user(msg: str)
        < return msg [string]

        registrar_log(msg: str)
        < return none      
    
    class formatarhora(h: str)
        formatar_hora_log(faixaIni_raw)
        < return h [string]
        
        formatar_hora_log(faixaFim_raw)
        < return h [string]
        
        formatar_hora_dig(faixaIni_raw)
        < return h [string]
        
        formatar_hora_dig(faixaFim_raw)
        < return h [string]

    class CSV():
        pedirCSV
        < return Nomecsv
    
        carregar_csv(Nomecsv: str)
        < return csv [list[dict]], cabecalho [list]
    
    class ProgramaLinha(csv):
        gerar_blocos(csv)
        < return blocos [list[dict]]
        
        seletorBlocos(csv, blocos)
        < return csv [list[dict]], blocos [list[dict]], bloco_inicio_index [int]
        
        preencher_blocos(csv, blocos, bloco_inicio_index)
        < return trecho [list], faixaFimAnterior [string], prox_idx [string], prox_id_bloco [string]
        
            preencher_faixa(row, linha_label, faixaFimAnterior)
            < return none


    class ImprimirPDFs(csv)
        tratarOso(csv)
        < return osos [list[dict]]
        
        seletorOsos(osos)
        < return osos [list[dict]], osos_inicial_index [int]
        
        preencher_PDFs(osos, osos_inicial_index)
        < return fQH [string], OsoAtiva [bool], OsoDerivada [bool],  row [int], osos [list[dict]]
        
            imprimirPDF(row, osos, OsoAtiva, OsoDerivada, fQH)
            < return none
} FIM